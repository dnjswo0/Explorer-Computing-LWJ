
import streamlit as st
import pandas as pd
import textwrap
import os, json, math
import matplotlib.pyplot as plt
import numpy as np
from scipy.stats import ttest_ind
import statsmodels.api as sm
from matplotlib import font_manager, rc
import platform
from pathlib import Path

# if platform.system() == 'Darwin':  # Mac OS
#     # ì‹œìŠ¤í…œ í°íŠ¸ í™•ì¸
#     for font in font_manager.findSystemFonts():
#         if "Nanum" in font or "AppleGothic" in font:
#             print(font)
#     # í°íŠ¸ ì§€ì • (ì˜ˆ: AppleGothic)
#     plt.rc('font', family='AppleGothic')
# else:  # Windows
#     font_path = "C:\Windows\Fonts\LG PC.ttf"
#     font_name = font_manager.FontProperties(fname=font_path).get_name()
#     plt.rc('font', family=font_name)

# ---- (í•œê¸€ í°íŠ¸ ì„¤ì •: Streamlit Cloudì—ì„œë„ ê¹¨ì§€ì§€ ì•Šê²Œ) ----
BASE_DIR = Path(__file__).resolve().parent
FONT_PATH = BASE_DIR / "fonts" / "LG_PC.ttf"

st.write("FONT exists?", FONT_PATH.exists(), FONT_PATH)  # ë””ë²„ê¹…

if FONT_PATH.exists():
    # 1) í°íŠ¸ íŒŒì¼ì„ matplotlib í°íŠ¸ ë§¤ë‹ˆì €ì— "ë“±ë¡" (ì´ê²Œ í•µì‹¬)
    font_manager.fontManager.addfont(str(FONT_PATH))

    # 2) ë“±ë¡ëœ í°íŠ¸ì˜ "íŒ¨ë°€ë¦¬ ì´ë¦„"ì„ ì–»ì–´ì„œ rcParamsì— ì ìš©
    font_name = font_manager.FontProperties(fname=str(FONT_PATH)).get_name()
    plt.rcParams["font.family"] = font_name
    plt.rcParams["axes.unicode_minus"] = False

    # (ì„ íƒ) ì ìš© í™•ì¸ìš©
    st.write("Using font:", font_name)
else:
    st.error(f"í°íŠ¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ìš”: {FONT_PATH}")
# --------------------------------------------------------


# ----------------------------
# ë©”ì¸ í™”ë©´ ì„¸íŒ…
# ----------------------------


st.title("ë°´ë“œ ë¶ì€ ì˜¨ë‹¤")

st.sidebar.header("ì»´í“¨íŒ… íƒìƒ‰ ê¸°ë§ í”„ë¡œì íŠ¸")

toc = {
    "0ì¥. 'ë°´ë“œ ë¶ì€ ì˜¨ë‹¤'" : ["0.1 ë°´ë“œ ë¶ì€ ì˜¨ë‹¤"],
    "1ì¥. ë°´ë“œì— ëŒ€í•œ ì´í•´": ["1.1 ë°´ë“œë€?", "1.2 ì—­ì‚¬ ë° ì¥ë¥´"],
    "2ì¥. ë°ì´í„°ë¡œ ë°”ë¼ë³´ëŠ” ë°´ë“œ ë¶": ["2.1 ë°ì´í„° ì½ê¸°", "2.2 ìŒì›ë°ì´í„°", "2.3 ë½í˜ìŠ¤í‹°ë²Œ"],
    "3ì¥. ë°´ë“œ ë¶ì€ ë¬´ì—‡ì„ ì‹œì‚¬í•˜ëŠ”ê°€": ["3.1 ì‹œì‚¬ì "],
    "4ì¥. ë°´ë“œ ìŒì•… ì¶”ì²œ": ["4.1 ìŒì•… ì¶”ì²œ"]
}

# ----------------------------
# ë°ì´í„° ì„¤ëª…
# ----------------------------


def read_prop():
    n1 = 500   # 2020~2024 ì „ì²´ ê³¡ ìˆ˜
    n2 = 100   # 2025ë…„ 11ì›” ê³¡ ìˆ˜

    k1 = 31   # 2020~2024 ë¡/ë©”íƒˆ ê³¡ ìˆ˜
    k2 = 11   # 2025ë…„ 11ì›” ë¡/ë©”íƒˆ ê³¡ ìˆ˜

    p1 = k1 / n1
    p2 = k2 / n2

    p_pool = (k1 + k2) / (n1 + n2)
    se = math.sqrt(p_pool * (1 - p_pool) * (1/n1 + 1/n2))
    z = (p1 - p2) / se if se != 0 else float("nan")
    alpha = 0.05
    df_test = pd.DataFrame({
        "í•­ëª©": [
            "í‘œë³¸ í¬ê¸° (nâ‚)",
            "í‘œë³¸ í¬ê¸° (nâ‚‚)",
            "ì„±ê³µ íšŸìˆ˜ (kâ‚)",
            "ì„±ê³µ íšŸìˆ˜ (kâ‚‚)",
            "í‘œë³¸ë¹„ìœ¨ (pâ‚)",
            "í‘œë³¸ë¹„ìœ¨ (pâ‚‚)",
            "í•©ë™í‘œë³¸ë¹„ìœ¨ (pÌ‚)",
            "í‘œì¤€ì˜¤ì°¨ (SE)",
            "ê²€ì •í†µê³„ëŸ‰ (z)",
            "ìœ ì˜ìˆ˜ì¤€ (Î±)"
        ],
        "ê°’": [
            n1,
            n2,
            k1,
            k2,
            round(p1, 3),
            round(p2, 3),
            round(p_pool, 3),
            round(se, 4),
            round(z, 3),
            alpha
        ],
        "ì„¤ëª…": [
            "2020~2024ë…„ ì „ì²´ ê³¡ ìˆ˜",
            "2025ë…„ 11ì›” ì „ì²´ ê³¡ ìˆ˜",
            "2020~2024ë…„ ë¡/ë©”íƒˆ ê³¡ ìˆ˜",
            "2025ë…„ 11ì›” ë¡/ë©”íƒˆ ê³¡ ìˆ˜",
            "kâ‚ / nâ‚",
            "kâ‚‚ / nâ‚‚",
            "(kâ‚ + kâ‚‚) / (nâ‚ + nâ‚‚)",
            "âˆš[ pÌ‚(1âˆ’pÌ‚)(1/nâ‚ + 1/nâ‚‚) ]",
            "(pâ‚ âˆ’ pâ‚‚) / SE",
            "ê²€ì • ê¸°ì¤€"
        ]
    })
    st.markdown("**â‰ï¸ ë‘ ëª¨ë¹„ìœ¨ì˜ ë¹„êµë¥¼ ìœ„í•œ z-ê²€ì • ìš”ì•½í‘œ**")
    st.dataframe(df_test, use_container_width=True)



# ----------------------------
# ìŒì›ë°ì´í„° ì‹œê°í™”
# ----------------------------

# json íŒŒì¼ì—ì„œ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ ë½‘ì•„ë‚´ê¸°
def load_rockmetal_count(json_path: str) -> int:
    """
    JSON êµ¬ì¡°: {"artist - title": {"songId": "...", ...}, ...}
    - songIdê°€ ë¹„ì–´ìˆëŠ” í•­ëª©ì€ ì œì™¸í•˜ê³  ì¹´ìš´íŠ¸
    """
    with open(json_path, "r", encoding="utf-8") as f:
        data = json.load(f)

    k = 0
    for _, v in data.items():
        if isinstance(v, dict) and str(v.get("songId", "")).strip() != "":
            k += 1
    return k


def build_year_count_df(file_map: dict, n_per_year: int = 100):
    """
    file_map ì˜ˆ:
    {2020:"rock_metal_2020_11.json", ..., 2025:"rock_metal_2025_11.json"}
    """
    rows = []
    for year, path in file_map.items():
        if not os.path.exists(path):
            raise FileNotFoundError(f"íŒŒì¼ì´ ì—†ì–´ìš”: {path}")

        k = load_rockmetal_count(path)
        rows.append({"year": year, "rock_metal_count": k, "n_total": n_per_year})

    df = pd.DataFrame(rows).sort_values("year").reset_index(drop=True)
    return df

#--------------------------

# ëª¨ë¹„ìœ¨ z-ê²€ì • (ë‹¨ì¸¡ ê²€ì •)
def norm_cdf(x: float) -> float:
    return 0.5 * (1.0 + math.erf(x / math.sqrt(2.0)))

def two_prop_ztest(k1, n1, k2, n2, alternative="greater"):
    """
    ë‘ ëª¨ë¹„ìœ¨ z-ê²€ì •
    H0: p1 = p2
    alternative="greater"ëŠ” H1: p1 > p2
    """
    p1 = k1 / n1
    p2 = k2 / n2
    p_pool = (k1 + k2) / (n1 + n2)
    se = math.sqrt(p_pool * (1 - p_pool) * (1 / n1 + 1 / n2))
    z = (p1 - p2) / se

    if alternative == "greater":
        pval = 1 - norm_cdf(z)
    elif alternative == "less":
        pval = norm_cdf(z)
    else:  # two-sided
        pval = 2 * (1 - norm_cdf(abs(z)))

    return p1, p2, z, pval

# ì‹œê°í™”
def plot_two_proportions(df, target_year=2025, baseline_years=(2020, 2021, 2022, 2023, 2024), n_per_year=100):
    """
    - baseline(2020~2024 í•©ì‚°) vs target(2025) ëª¨ë¹„ìœ¨ ë¹„êµ
    - ë§‰ëŒ€ + 95% CI ì—ëŸ¬ë°”
    """
    k_target = int(df.loc[df["year"] == target_year, "rock_metal_count"].values[0])
    n_target = n_per_year

    k_base = int(df[df["year"].isin(baseline_years)]["rock_metal_count"].sum())
    n_base = n_per_year * len(baseline_years)

    p1, p2, z, pval = two_prop_ztest(k_target, n_target, k_base, n_base, alternative="greater")

    # 95% CI (unpooled ê·¼ì‚¬)
    z975 = 1.96
    ci_target = z975 * math.sqrt(p1 * (1 - p1) / n_target)
    ci_base = z975 * math.sqrt(p2 * (1 - p2) / n_base)

    fig = plt.figure()
    labels = [f"{min(baseline_years)} ~ {max(baseline_years)}", f"{target_year}"]
    vals = [p2, p1]
    errs = [ci_base, ci_target]

    plt.bar(labels, vals, yerr=errs, capsize=8, color = ["#5d86c9", "#142847"], alpha =0.9)
    plt.ylim(0, max(vals) + 0.15)
    plt.ylabel("ë¡/ë©”íƒˆ ê³¡ ìˆ˜ì˜ ë¹„ìœ¨ (TOP100 ê¸°ì¤€)")
    plt.title(f"ëª¨ë¹„ìœ¨ ë¹„êµ (ë‹¨ì¸¡ê²€ì • p={pval:.4g})")
    plt.tight_layout()

    stats = {
        "k_target": k_target, "n_target": n_target, "p_target": p1,
        "k_base": k_base, "n_base": n_base, "p_base": p2,
        "z": z, "p_value": pval
    }
    return fig, stats


#--------------------------
# íšŒê·€ë¶„ì„ (ì‚°ì ë„ + íšŒê·€ì§ì„ )
def plot_regression(df):
    """
    ë‹¨ìˆœíšŒê·€: rock_metal_count ~ year
    ì‚°ì ë„ + íšŒê·€ì§ì„ 
    """
    x = df["year"].astype(float).values
    y = df["rock_metal_count"].astype(float).values

    X = sm.add_constant(x)
    model = sm.OLS(y, X).fit()
    yhat = model.predict(X)

    fig = plt.figure()
    plt.scatter(x, y, color = "#93c4a2")
    plt.plot(x, yhat, color = "#054217")
    plt.xlabel("ì—°ë„")
    plt.ylabel("ë¡/ë©”íƒˆ ê³¡ ìˆ˜ (TOP 100)")
    plt.title(f"íšŒê·€ì§ì„ \nê¸°ìš¸ê¸°={model.params[1]:.3f}, RÂ²={model.rsquared:.3f}, F p={model.f_pvalue:.4g}")
    plt.tight_layout()

    stats = {
        "beta0": model.params[0],
        "beta1": model.params[1],
        "r2": model.rsquared,
        "f": model.fvalue,
        "f_pvalue": model.f_pvalue
    }
    return fig, stats


# -------------------------
# (3) t-test
def plot_ttest(df, cut_year=2023):
    """
    ê·¸ë£¹1: <= cut_year (2020~2023)
    ê·¸ë£¹2: >= cut_year+1 (2024~2025)
    Welch t-test + ë°•ìŠ¤í”Œë¡¯ + ì 
    """
    before = df[df["year"] <= cut_year]["rock_metal_count"].values
    after = df[df["year"] >= (cut_year + 1)]["rock_metal_count"].values

    # Welch t-test (ë“±ë¶„ì‚° ê°€ì • X), ë‹¨ì¸¡: after > before
    t_stat, p_val = ttest_ind(after, before, equal_var=False, alternative="greater")

    order = [f"~{cut_year}", f"{cut_year+1}~"]
    data = [before, after]

    fig = plt.figure()
    plt.boxplot(data, labels=order, showfliers=False)

    # ê°œë³„ ì 
    for i, y in enumerate(data, start=1):
        x = i + (np.random.rand(len(y)) - 0.5) * 0.08
        plt.scatter(x, y, color = "#2e1169")

    plt.ylabel("ë¡/ë©”íƒˆ ê³¡ ìˆ˜ (TOP 100)")
    plt.title(f"t-ê²€ì •(ë‹¨ì¸¡)\np={p_val:.4g}  (after > before)")
    plt.tight_layout()

    stats = {
        "mean_before": float(np.mean(before)),
        "mean_after": float(np.mean(after)),
        "t": float(t_stat),
        "p_value": float(p_val),
        "n_before": int(len(before)),
        "n_after": int(len(after))
    }
    return fig, stats

# ----------------------------
# ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜ íšŒê·€ë¶„ì„
# ----------------------------  

def penta_regression(df, predict_year = 2026):
    x = df["year"].astype(float).values
    y = df["visitor"].astype(float).values

    X = sm.add_constant(x)
    model = sm.OLS(y, X).fit()
    yhat = model.predict(X)

    x_new = np.array([2026.0])      # shape (1,)
    X_new = sm.add_constant(x_new, has_constant='add')   # shape (1, 2)

    y_pred_2026 = model.predict(X_new)[0]

    fig = plt.figure()
    plt.scatter(x, y, label="ê´€ì¸¡ê°’", color = "#37547a")
    plt.plot(x, yhat, label="íšŒê·€ì§ì„ ", color = "#1c2945")

    plt.scatter(predict_year, y_pred_2026, color="#752b2b", zorder=5, label="2026ë…„ ì˜ˆì¸¡")
    plt.axvline(predict_year, linestyle="--", color="#ab8787", alpha=0.5)

    plt.xlabel("ì—°ë„")
    plt.ylabel("ì¸ì²œ íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ ì°¸ê°€ì ìˆ˜")
    plt.title(
        f"íšŒê·€ì§ì„ : ê¸°ìš¸ê¸°={model.params[1]:.1f}, "
        f"RÂ²={model.rsquared:.3f}, F p={model.f_pvalue:.4g}"
    )
    plt.legend()
    plt.tight_layout()

    stats = {
        "beta0": model.params[0],
        "beta1": model.params[1],
        "r2": model.rsquared,
        "f": model.fvalue,
        "f_pvalue": model.f_pvalue,
        "pred_2026": y_pred_2026
    }

    return fig, stats

# ----------------------------
# ì„¹ì…˜ë³„ ë‚´ìš© í•¨ìˆ˜
# ----------------------------

def section_0_1():
    st.write("""
    ### ì»´í“¨íŒ… íƒìƒ‰ ê¸°ë§ í”„ë¡œì íŠ¸
    2024-13880 ì´ì›ì¬

    **ì£¼ì œ : ë°´ë“œ ë¶ì€ ì™”ëŠ”ê°€?**
    """)
    img_path = os.path.join("finalexam", "images", "img3.jpg")
    st.image(img_path, caption="ë°´ë“œ ë¶ì€ ì˜¨ë‹¤")      
    # st.image("finalexam/images/img3.jpg", caption="ë°´ë“œ ë¶ì€ ì˜¨ë‹¤")
    st.write("""
    ë¶ˆê³¼ ëª‡ ë…„ ì „ê¹Œì§€ë§Œí•´ë„ ë¡ì€ ë¹„ì£¼ë¥˜ ì¥ë¥´ì˜€ìœ¼ë‚˜, íŒ¬ë°ë¯¹ ì´í›„ ê³µì—° ë° í˜ìŠ¤í‹°ë²Œ ì—…ê³„ê°€ ë˜ì‚´ì•„ë‚˜ë©´ì„œ ìƒí™©ì´ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤.
    ì¸ì²œ íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œì€ 15ë§Œì„ ì „ì„ ë§¤ì§„ì„ ê¸°ë¡í–ˆê³ , ë°´ë“œ ì‹¤ë¦¬ì¹´ê²”ì˜ ë©œë¡ ë®¤ì§ì–´ì›Œì¦ˆ ë¬´ëŒ€, í•œêµ­ëŒ€ì¤‘ìŒì•…ìƒ ìˆ˜ìƒ ë“± ë°´ë“œ ìŒì•…ì˜ ì—´í’ì´ ì´ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤.
    ì´ì™¸ì—ë„ ì”ë‚˜ë¹„, í•œë¡œë¡œ, QWER, ë°ì´ì‹ìŠ¤ ë“± ë‹¤ìˆ˜ì˜ ë°´ë“œê°€ êµ­ë‚´ í˜ìŠ¤í‹°ë²Œ ë¼ì¸ì—…ì— í¬í•¨ëœ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ì´ëŸ¬í•œ íë¦„ì„ ë³´ë©´, ë½ì€ ì£¼ë¥˜ë¡œ ì§„ì…í•˜ëŠ” ë¶„ê¸°ì ì— ë‹¤ë‹¤ë¥¸ ë“¯í•©ë‹ˆë‹¤.


    ì´ì™€ ê´€ë ¨í•´ 2024ë…„ì¦ˆìŒë¶€í„°, ìš°ë¦¬ë‚˜ë¼ ìŒì•…ê³„ì—ì„œ ì„œë™ìš” ê¸°ë²•ì²˜ëŸ¼ **ë°´ë“œ ë¶ì€ ì˜¨ë‹¤**ëŠ” ë§ì´ í†µìš©ëìŠµë‹ˆë‹¤.
    ì´ëŠ” ë°´ë“œ ìŒì•…ì˜ ë¶€í¥ì„ ë°”ë¼ëŠ” ì‚¬ëŒë“¤ì˜ ì—¼ì›ì„ ë‹´ì€ ìœ í–‰ì–´ë¡œ í•´ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


    ì´ì œ ì—¬ê¸°ì„œ ìƒê°í•´ë³´ì•„ì•¼ í•  ì ì€, **ì‹¤ì œë¡œ ë°´ë“œ ë¶ì´ ì™”ëŠ”ê°€**ì…ë‹ˆë‹¤.


    ì´ì— í˜„ ëŒ€ì‹œë³´ë“œì—ì„œëŠ” ë°´ë“œ ìŒì•…ì— ëŒ€í•´ ê°„ëµíˆ ì†Œê°œí•˜ê³ , ì •ë§ë¡œ **ë°´ë“œ ë¶ì´ ì™”ëŠ”ì§€**ì— ëŒ€í•´ ë‹¤ì–‘í•œ ë°ì´í„°ë¡œ í™•ì¸í•´ë³´ê³ ì í•©ë‹ˆë‹¤.
    """)

    st.caption("""
    **ì¶œì²˜**

    ìœ ìŠ¹ìƒ, 'ë°´ë“œ ë¶ì€ ì˜¨ë‹¤? ì•„ë‹ˆ ì™”ë‹¤!', êµ­ë¦½í•œêµ­êµí†µëŒ€ì‹ ë¬¸, 2025.10.06

    ìœ ì˜ì„œ, â€œ9ì›”ì˜ ë¬¸í™” 2018 íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ - â€˜ë½ì•Œëª»â€™ì˜ ë½í˜ íƒë°©ê¸°_ì¼ìƒì„ ìŠê³  ë‹¬ë¦¬ëŠ” í™˜í¬ì™€ ì—´ì •ì˜ ìˆœê°„â€ ìœ ë ˆì¹´,(418), 10-13. 2018, 9. 

    ì¥ì¤€í™˜, â€œ[ì¼ì‚¬ì¼ì–¸] "ë°´ë“œ ë¶ì€ ì˜¨ë‹¤"â€ ì¡°ì„ ì¼ë³´, 2024.05.06, https://www.chosun.com/culture-life/culture_general/2024/05/06/ZMDHVFOX2JF6ZGHPZX5M5SMWXY/
    """)



def section_1_1():
    st.header("1.1 ë°´ë“œë€?")

    col1, col2 = st.columns(2)
    with col1:
        img_path1 = os.path.join("finalexam", "images", "img1.jpg")
        st.image(img_path1, caption="íœíƒ€í¬íŠ¸ ë°©ë¬¸ ì‚¬ì§„_1")
        # st.image("finalexam/images/img1.jpg", caption="íœíƒ€í¬íŠ¸ ë°©ë¬¸ ì‚¬ì§„_1")
    with col2:
        img_path2 = os.path.join("finalexam", "images", "img2.jpg")
        st.image(img_path2, caption="íœíƒ€í¬íŠ¸ ë°©ë¬¸ ì‚¬ì§„_2")
        # st.image("finalexam/images/img2.jpg", caption="íœíƒ€í¬íŠ¸ ë°©ë¬¸ ì‚¬ì§„_2")

    st.markdown("#### ğŸ¸ ë°´ë“œ")
    st.write("""
    ë°´ë“œ(band)ëŠ” ìŒì•…ì„ ì—°ì£¼í•˜ëŠ” ë‹¨ì²´ì¸ â€˜ì•…ë‹¨â€™ì„ ì¼ì»«ëŠ” ë§ì…ë‹ˆë‹¤.  
    ë¡ ë°´ë“œ ë¿ë§Œ ì•„ë‹ˆë¼ ì˜¤ì¼€ìŠ¤íŠ¸ë¼, ë¸Œë¼ìŠ¤ ë°´ë“œ, ë³´ì»¬ ë°´ë“œ, íŒ ë°´ë“œ, ë³´ì´ ë°´ë“œ ë“± ì•…ë‹¨ ì „ë°˜ì„ ê°€ë¦¬í‚¤ëŠ” ë§ì´ì–´ì„œ,  
    â€˜musical groupâ€™ê³¼ â€˜musical bandâ€™ë‚˜ ì˜ë¯¸ì— í° ì°¨ì´ê°€ ì—†ìŠµë‹ˆë‹¤.
    ê·¸ëŸ¬ë‚˜ í•œêµ­ì–´ì— ì™¸ë˜ì–´ë¡œ ë“¤ì–´ì˜¨ â€˜ë°´ë“œâ€™ëŠ” ë³´í†µ ë¡ì´ë‚˜ ë©”íƒˆ ë°´ë“œë§Œì„ ê°€ë¦¬í‚¤ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.  
    ì¦‰, ì¼ë ‰ ê¸°íƒ€, ë² ì´ìŠ¤ ê¸°íƒ€, í‚¤ë³´ë“œ, ë“œëŸ¼ì˜ êµ¬ì„±ì¸ ë¡, ë©”íƒˆ ë°´ë“œë¥¼ ì¼ë°˜ì ìœ¼ë¡œ ë– ì˜¬ë¦½ë‹ˆë‹¤.

    **í˜„ ëŒ€ì‹œë³´ë“œì—ì„œëŠ” 'ë¡/ë©”íƒˆ' ì¥ë¥´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°´ë“œ ìŒì•…ì„ ì„¤ëª…í•©ë‹ˆë‹¤.**
    """)
    st.caption("ì¶œì²˜ : ë‚˜ë¬´ìœ„í‚¤ â€˜ë°´ë“œâ€™")

def section_1_2():
    st.header("1.2 ì—­ì‚¬ ë° ì¥ë¥´")
    st.write("""
    ë°´ë“œ ìŒì•…ì€ ê¸´ ì—­ì‚¬ì™€ ë‹¤ì–‘í•œ ì¥ë¥´ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. 
    ì´ í˜ì´ì§€ì—ì„œ ì—­ì‚¬/ì¥ë¥´ì— ëŒ€í•œ ê°„ëµí•œ ì„¤ëª…ê³¼ ê´€ë ¨ ì˜ìƒì„ ì‹œì²­í•˜ì„¸ìš”.
    """)

    st.subheader("âŒ› ì—­ì‚¬")
    st.write("""
    ë¡ ìŒì•…ì€ ë‹¨ìˆœí•œ ìŒì•… ì¥ë¥´ê°€ ì•„ë‹ˆë¼ **ë¬¸í™”, ì‚¶ì˜ íƒœë„, ì²­ë…„ ì •ì²´ì„±**ì„ ëŒ€í‘œí•˜ëŠ” ìŒì•…ìœ¼ë¡œ ë“±ì¥í–ˆìŠµë‹ˆë‹¤.
    ì•„ë˜ëŠ” ê°„ë‹¨í•œ ë¡ì˜ ì—­ì‚¬ë¥¼ ê¸°ìˆ í•œ ê²ƒì…ë‹ˆë‹¤.

    1. ë¡œí°ë¡¤ì˜ íƒ„ìƒ (1950ë…„ëŒ€)
    - í‘ì¸ ë¸”ë£¨ìŠ¤ + ë°±ì¸ ì»¨íŠ¸ë¦¬ ìŒì•…ì˜ ê²°í•©
    - ëŒ€í‘œ ì¸ë¬¼ : ì—˜ë¹„ìŠ¤ í”„ë ˆìŠ¬ë¦¬, ì²™ ë² ë¦¬, ë¦¬í‹€ ë¦¬ì²˜ë“œ

    2. ë¸Œë¦¬í‹°ì‹œ ì¸ë² ì´ì „ (1960ë…„ëŒ€)
    - ë¯¸êµ­ ë¡œí°ë¡¤ì˜ ì¹¨ì²´ ì´í›„, ì˜êµ­ ë°´ë“œë“¤ì´ ë¯¸êµ­ ì‹œì¥ì„ ì¥ì•…
    - ëŒ€í‘œ : ë¹„í‹€ì¦ˆ, ë¡¤ë§ ìŠ¤í†¤ìŠ¤

    3. ë¡ì˜ ë¶„í™”ì™€ ì¦ì‹ (1970ë…„ëŒ€ ì´í›„)
    - ë¡ì€ í•˜ë‚˜ì˜ ì–‘ì‹ì— ë¨¸ë¬´ë¥´ì§€ ì•Šê³  ëŠì„ì—†ì´ í•˜ìœ„ ì¥ë¥´ë¡œ ë¶„í™”ë˜ë©° í™•ì¥
    """)

    st.markdown("**[Youtube] 10ë¶„ë§Œì— ë³´ëŠ” ë½ì˜ ì—­ì‚¬&ë³€ì²œì‚¬ (1950s ~2000s)**")
    st.video("https://youtu.be/uiDCaUwb_1Y?si=XsMjVlzu4sUopt2o")

    st.subheader("ğŸŒŸ ì¥ë¥´")
    st.write("""
    ë°´ë“œ(ë¡/ë©”íƒˆ) ì¥ë¥´ëŠ” ë§¤ìš° ë‹¤ì–‘í•˜ê³  ê° ì¥ë¥´ì— í•´ë‹¹í•˜ëŠ” ìŒì•…ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•˜ê¸° ì–´ë ¤ìš´ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

    ëŒ€í‘œì ì¸ ë¡ ì¥ë¥´ë¥¼ ì•„ë˜ ëª‡ ê°€ì§€ ì†Œê°œí•˜ê² ìŠµë‹ˆë‹¤.

    1. ì‚¬ì´í‚¤ë¸ë¦­ ë¡ (Psychedelic Rock)
    - ëª½í™˜ì , í™˜ê°ì  ë¶„ìœ„ê¸°
    - ì•½ë¬¼ ê²½í—˜ê³¼ ì˜ì‹ í™•ì¥ í‘œí˜„

    2. í”„ë¡œê·¸ë ˆì‹œë¸Œ ë¡ (Progressive Rock)
    - ë¡ì— ë³µì¡í•œ í™”ì„±ê³¼ êµ¬ì¡°ë¥¼ ì ‘ëª©
    - ì½˜ì…‰íŠ¸ ì•¨ë²”ê³¼ ì‚¬ìš´ë“œ ì‹¤í—˜ì´ íŠ¹ì§•

    3. í•˜ë“œ ë¡ / í—¤ë¹„ ë©”íƒˆ (Hard Rock / Heavy Metal)
    - ê°•ë ¥í•œ ê¸°íƒ€ ë¦¬í”„, í­ë°œì ì¸ ì‚¬ìš´ë“œ
    - ê³ í•¨ì¹˜ëŠ” ë³´ì»¬, ê³ ë‚œë„ ê¸°íƒ€ ì—°ì£¼

    4. í‘í¬ ë¡ (Punk Rock)
    - ë¡ì˜ ì—˜ë¦¬íŠ¸ì£¼ì˜ì— ëŒ€í•œ ê°•í•œ ë°˜ë°œ
    - ë‹¨ìˆœí•œ ì½”ë“œ ë°˜ë³µ, ë¹ ë¥¸ ë¦¬ë“¬
    - ì‚¬íšŒ, ì •ì¹˜, ê²½ì œ ì§ˆì„œì— ëŒ€í•œ ì¡°ë¡±ê³¼ ê³µê²©

    5. ëª¨ë˜ ë¡ / ê·¸ëŸ°ì§€ / ë¸Œë¦¿íŒ (Modern Rock ê³„ì—´)
    - ë¬¼ì§ˆë§ŒëŠ¥ì£¼ì˜, ì—˜ë¦¬íŠ¸ ì£¼ì˜ ë¹„íŒ
    - 1990ë…„ëŒ€ ì´í›„ ì–¸ë”ê·¸ë¼ìš´ë“œ ì¤‘ì‹¬
    """)

    col1, col2 = st.columns(2)
    with col1:
        st.markdown("**[Youtube] ë°´ë“œì˜ì•Œ ë‹¹ì‹ ë„ ë  ìˆ˜ ìˆë‹¤**")
        st.video("https://youtube.com/embed/YMnX8fMPAxQ?si=ha8Y5FdSkERw5w9p")
    with col2:
        st.markdown("**[Youtube] í•œêµ­ ë°´ë“œë¡œ ë©”íƒˆ ì¥ë¥´ ì¢…ë¥˜ ì•Œì•„ë³´ê¸°â˜ ï¸**")
        st.video("https://youtube.com/embed/YSY9WTOC9UY?si=w--x-bzApcgtsvyV")

    st.markdown("---")
    st.caption("ğŸ“ ë°ì´í„° ì¶œì²˜ : ìŒì•…ê³¼ ì‚¬íšŒ(ì´ì„œí˜„) ê°•ì˜ ìë£Œ")


def section_2_1():
    st.header("2.1 ë°ì´í„° ì½ê¸°")
    st.write("""
    ì´ ëŒ€ì‹œë³´ë“œëŠ” ì´ 2ê°€ì§€ ë°ì´í„°,\n
    **ìŒì› ë°ì´í„°**, **ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëª¨ë¹„ìœ¨ ê²€ì •, íšŒê·€ë¶„ì„, t-ê²€ì • ë“±ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.\n
    ì´í›„ ê° ë¶„ì„ ë° ê²€ì • ê²°ê³¼ë¥¼ ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•œ ë’¤, ê²°ê³¼ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.
    """)

    st.markdown("---")

    st.subheader("ğŸ“Š ë°ì´í„° ë¶„ì„ ë°©ë²•")
    st.markdown("#### ğŸµ ìŒì› ë°ì´í„°")
    st.markdown("""
    ë©œë¡  2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ ì—°ê°„ TOP 100 ì°¨íŠ¸, ê·¸ë¦¬ê³  2025ë…„ 11ì›” ì›”ê°„ ì°¨íŠ¸ ì¤‘ ë¡/ë©”íƒˆ ì¥ë¥´ ê³¡ë“¤ì˜ ì •ë³´ë¥¼ Seleniumì„ í™œìš©í•´ ê°€ì ¸ì™€ jsoníŒŒì¼ë¡œ ì €ì¥í•œ ë’¤ ë¶„ì„ì— í™œìš©í•©ë‹ˆë‹¤.

    json íŒŒì¼ í˜•ì‹ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.
    """)
    st.json({
        "í•œë¡œë¡œ - ì‚¬ë‘í•˜ê²Œ ë  ê±°ì•¼": {
        "artist": "í•œë¡œë¡œ",
        "title": "ì‚¬ë‘í•˜ê²Œ ë  ê±°ì•¼",
        "genre": "ì¸ë””ìŒì•…, ë¡/ë©”íƒˆ",
        "albumId": "10923444",
        "songId": "36730261"
    },
    "DAY6 (ë°ì´ì‹ìŠ¤) - í•œ í˜ì´ì§€ê°€ ë  ìˆ˜ ìˆê²Œ": {
        "artist": "DAY6 (ë°ì´ì‹ìŠ¤)",
        "title": "í•œ í˜ì´ì§€ê°€ ë  ìˆ˜ ìˆê²Œ",
        "genre": "ë¡/ë©”íƒˆ",
        "albumId": "10923444",
        "songId": "31927275"
    }
    })
    st.caption("rock_metal_2025_11.json ä¸­ ì¼ë¶€")

    st.markdown("""
    ìœ„ì˜ json íŒŒì¼ 5ê°œ(rock_metal_2020.json ~ rock_metal_2025_11.json)ì„ í™œìš©í•˜ì—¬ ëª¨ë¹„ìœ¨ ê²€ì •, íšŒê·€ë¶„ì„, t-ê²€ì •ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    """)
    st.markdown("""
    1. **ëª¨ë¹„ìœ¨ ê²€ì •**
       - 2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ì˜ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ì˜ ë¹„ìœ¨ê³¼ 2025ë…„ 11ì›” ë¡/ë©”íƒˆ ê³¡ìˆ˜ì˜ ë¹„ìœ¨ì„ ë¹„êµí•˜ëŠ” ê²€ì •ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
       - ì´ë¥¼ í†µí•´ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ê°€ ì§€ë‚œ ì‹œê¸°(2020~2024ë…„)ê³¼ ë¹„êµí•˜ì—¬ ìµœê·¼(2025ë…„ 11ì›”)ì— í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€í•˜ì˜€ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
       - í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€í•˜ì˜€ë‹¤ë©´, ìœ„ì˜ ë¶„ì„ ê²°ê³¼ëŠ” ë°´ë“œ ë¶ì´ ì™”ë‹¤ëŠ” ê²ƒì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    2. **íšŒê·€ ë¶„ì„**  
       - ë‹¨ìˆœíˆ 2020~2024ë…„, 2025ë…„ 11ì›” ë‘ ì§‘ë‹¨ìœ¼ë¡œ ìª¼ê°œì„œ ë³´ê¸°ë³´ë‹¤ëŠ”,
       - ì–´ë–»ê²Œ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ê°€ ì¦ê°€/ê°ì†Œí•´ì™”ëŠ”ì§€ ê·¸ ì¶”ì´ë¥¼ ì‚°ì ë„ë¡œ íŒŒì•…í•˜ê³ , íšŒê·€ëª¨í˜•ì„ í†µí•´ ì¦ê°€/ê°ì†Œ ê¸°ìš¸ê¸°ë¥¼ ì•Œì•„ë³´ê³ ì í•©ë‹ˆë‹¤.
       - íšŒê·€ëª¨í˜•ì˜ ê¸°ìš¸ê¸°ì— ëŒ€í•œ ì¶”ë¡ ì„ í†µí•´ ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ê³ , ì§ì„ ê´€ê³„ì˜ ìœ ì˜ì„±ì„ í™•ì¸í•˜ê¸° ìœ„í•´ ê²°ì •ê³„ìˆ˜ë¥¼ í™œìš©í•œ Fê²€ì •ì„ ì§„í–‰í•©ë‹ˆë‹¤.
       - ë§Œì•½ ì§ì„ ê´€ê³„ê°€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ë‹¤ê³ , ê¸°ìš¸ê¸°ê°€ ì–‘ìˆ˜ë¼ë©´, ìœ„ì˜ ë¶„ì„ ê²°ê³¼ëŠ” ë°´ë“œ ë¶ì´ ì™”ë‹¤ëŠ” ê²ƒì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    3. **ë‘ ëª¨í‰ê· ì— ëŒ€í•œ t-ê²€ì •**  
       - ì‚°ì ë„ë¥¼ íŒŒì•…í•´ ë‘ ì§‘ë‹¨ìœ¼ë¡œ ë¶„ë¥˜í•˜ê³ , ë‘ ì§‘ë‹¨ì˜ ëª¨í‰ê· ì— ëŒ€í•œ t-ê²€ì •ì„ ì‹¤ì‹œí•©ë‹ˆë‹¤. 
       - ì´í‘œë³¸ t-ê²€ì •ì„ í†µí•´ 2024-2025ë…„ì— í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê²Œ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ê°€ ì¦ê°€í•œ ê²ƒì´ ë§ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. 
       - í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€í•˜ì˜€ë‹¤ë©´, ìœ„ì˜ ë¶„ì„ ê²°ê³¼ëŠ” ë°´ë“œ ë¶ì´ ì™”ë‹¤ëŠ” ê²ƒì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    """)

    st.markdown("#### ğŸ•º ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜")
    st.markdown("""
    íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ 2019, 2022, 2023, 2024, 2025ë…„ ê´€ëŒê°ìˆ˜ë¥¼ í†µí•´ ê´€ëŒê° ìˆ˜ê°€ ì¦ê°€/ê°ì†Œí•˜ì˜€ëŠ”ì§€ í™•ì¸í•˜ê³ , 
    2026ë…„ ê´€ëŒê° ìˆ˜ê¹Œì§€ íšŒê·€ë¶„ì„ì„ í™œìš©í•˜ì—¬ ì˜ˆì¸¡í•´ë³´ê³ ì í•©ë‹ˆë‹¤.
    """)
    st.warning("2021, 2022ë…„ì—ëŠ” ì½”ë¡œë‚˜ë¡œ ì¸í•´ í˜ìŠ¤í‹°ë²Œì´ ì˜¨ë¼ì¸ìœ¼ë¡œ ì§„í–‰ë˜ì—ˆìœ¼ë¯€ë¡œ ê´€ëŒê° ìˆ˜ ì´ìƒì¹˜ê°€ ë°œìƒí•´ í•´ë‹¹ ì—°ë„ ë°ì´í„°ë¥¼ ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤")

    st.markdown("---")

    st.markdown("#### ğŸ’¡ ë¶„ì„ ê²°ê³¼ì˜ ì˜ì˜")
    st.info("""
    - ìŒì›ë°ì´í„°, íœíƒ€í¬íŠ¸ ê´€ëŒê° ìˆ˜ ìë£Œë¥¼ í†µê³„ì  ê²€ì • ë°©ë²•ìœ¼ë¡œ ë¶„ì„í•¨ìœ¼ë¡œì¨ ë¶„ì„ ê²°ê³¼ì˜ ì‹ ë¢°ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆìŒ.
    - Seleniumì„ í†µí•œ ë™ì  ì›¹í¬ë¡¤ë§ìœ¼ë¡œ ê°•ì˜ ë‚´ìš©ì„ ì ì ˆíˆ í™œìš©í•¨.
    - ë°ì´í„° ì‹œê°í™”ë¥¼ streamlit ëŒ€ì‹œë³´ë“œì— ì—…ë¡œë“œí•¨ìœ¼ë¡œì¨ ê°•ì˜ ë‚´ìš©ì„ ì ì ˆíˆ í™œìš©í•¨.
    """)





def section_2_2():
    st.header("2.2 ìŒì›ë°ì´í„°")

    file_map = {
        2020: os.path.join(BASE_DIR, "rock_metal_2020.json"),
        2021: os.path.join(BASE_DIR, "rock_metal_2021.json"),
        2022: os.path.join(BASE_DIR, "rock_metal_2022.json"),
        2023: os.path.join(BASE_DIR, "rock_metal_2023.json"),
        2024: os.path.join(BASE_DIR, "rock_metal_2024.json"),
        2025: os.path.join(BASE_DIR, "rock_metal_2025_11.json"),
    }

    # íŒŒì¼ ì¡´ì¬ ì²´í¬
    missing = [p for p in file_map.values() if not os.path.exists(p)]
    if missing:
        st.error("ì•„ë˜ íŒŒì¼ì´ bandboom.pyì™€ ê°™ì€ í´ë”ì— ì—†ì–´ìš”:\n\n- " + "\n- ".join(missing))
        return

    df = build_year_count_df(file_map, n_per_year=100)

    st.subheader("ğŸ“† ì—°ë„ë³„ ë¡/ë©”íƒˆ ê³¡ ìˆ˜")
    st.dataframe(df, use_container_width=True)
    st.markdown("**ì•„ë˜ ì„¸ ê°€ì§€ íƒ­ì—ì„œ ìœ„ ë°ì´í„° ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”**")

    tab1, tab2, tab3 = st.tabs(["1) ëª¨ë¹„ìœ¨ ê²€ì •", "2) íšŒê·€ë¶„ì„", "3) t-ê²€ì •"])

    with tab1:
        st.subheader("ëª¨ë¹„ìœ¨ ê²€ì •")
        st.markdown("""
        - 2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ì˜ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ì˜ ë¹„ìœ¨ê³¼ 2025ë…„ 11ì›” ë¡/ë©”íƒˆ ê³¡ìˆ˜ì˜ ë¹„ìœ¨ì„ ë¹„êµí•˜ëŠ” ê²€ì •ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. 
        - ì´ë¥¼ í†µí•´ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ê°€ ì§€ë‚œ ì‹œê¸°(2020~2024ë…„)ê³¼ ë¹„êµí•˜ì—¬ ìµœê·¼(2025ë…„ 11ì›”)ì— í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€í•˜ì˜€ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. 
        - í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€í•˜ì˜€ë‹¤ë©´, ìœ„ì˜ ë¶„ì„ ê²°ê³¼ëŠ” ë°´ë“œ ë¶ì´ ì™”ë‹¤ëŠ” ê²ƒì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        """)
        fig, stats = plot_two_proportions(df, target_year=2025, baseline_years=(2020,2021,2022,2023,2024), n_per_year=100)
        st.pyplot(fig)
        plt.close(fig)
        st.write("ê²€ì • ê²°ê³¼(ìˆ«ì):")
        st.json(stats)

        read_prop()

        st.markdown("##### ğŸ“Œ ëª¨ë¹„ìœ¨(z-ê²€ì •) ê²°ê³¼ ìš”ì•½")
        prop_counts = {
            "ì—°ë„/ì›”": ["2020", "2021", "2022", "2023", "2024", "2025_11"],
            "ë¡/ë©”íƒˆ ê³¡ ìˆ˜ (TOP100 ê¸°ì¤€)": [7, 6, 5, 4, 9, 11]
        }
        st.dataframe(prop_counts, use_container_width=False)

        # í•µì‹¬ ìˆ˜ì¹˜ ìš”ì•½ (metric)
        c1, c2, c3 = st.columns(3)
        c1.metric("p(2020~2024ë…„)", "0.0620", "k=31 / n=500")
        c2.metric("p(2025ë…„ 11ì›”)", "0.1100", "k=11 / n=100")
        c3.metric("ì°¨ì´ (p(2025ë…„ 11ì›”) - p(2020~2024ë…„))", "0.0480", "ì¦ê°€")

        st.markdown("""
        **ê°€ì„¤ ì„¤ì •**
        - **ê·€ë¬´ê°€ì„¤(Hâ‚€)**: pâ‚ = pâ‚‚  (2020~2024ì˜ ë¹„ìœ¨ = 2025ë…„ 11ì›”ì˜ ë¹„ìœ¨)
        - **ëŒ€ë¦½ê°€ì„¤(Hâ‚)**: pâ‚ < pâ‚‚  (2025ë…„ 11ì›”ì˜ ë¹„ìœ¨ì´ ë” í¼)
        """)

        st.markdown("""
        **[ë‘ ëª¨ë¹„ìœ¨ z-ê²€ì • ê²°ê³¼]**
        - pooled p = **0.0700**
        - SE = **0.027950**
        - z = **1.7174**
        - p-value (one-sided, Hâ‚: 2025 > 2020~2024) = **0.0429571**
        """)

        st.success("p-value < 0.05 ì´ë¯€ë¡œ, ìœ ì˜ìˆ˜ì¤€ 5%ì—ì„œ ê·€ë¬´ê°€ì„¤(Hâ‚€)ì„ ê¸°ê°í•©ë‹ˆë‹¤.\nâ†’ 2025ë…„ 11ì›”ì˜ ë¡/ë©”íƒˆ ë¹„ìœ¨ì´ 2020~2024ë…„ ëŒ€ë¹„ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€í–ˆìŠµë‹ˆë‹¤.")

        st.markdown("""
        ë¹„ìœ¨ ì°¨ì´: p(2025_11) âˆ’ p(2020~2024)
        - diff = 0.0480
        - 95% CI â‰ˆ [-0.0169, 0.1129]
        """)

        st.markdown("##### âœï¸ í•´ì„")
        st.info("""
        - 2025ë…„ 11ì›” TOP100ì—ì„œ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ ë¹„ìœ¨ì´ 2020~2024ë…„ì˜ í‰ê· ì  ë¹„ìœ¨ë³´ë‹¤ **í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê²Œ ë†’ê²Œ ê´€ì¸¡**ë˜ì—ˆìŠµë‹ˆë‹¤.
        - ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ **ìµœê·¼ ë°´ë“œ/ë¡ ìŒì•…ì´ ë” ì£¼ëª©ë°›ê³  ìˆì„ ê°€ëŠ¥ì„±**ì„ ì œì‹œí•  ìˆ˜ ìˆìœ¼ë©°, â€œë°´ë“œ ë¶ì´ ì™”ë‹¤â€ëŠ” ê°€ì„¤ì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        """)

        st.markdown("---")

        st.caption("ğŸ“ ë°ì´í„° ì¶œì²˜: ë©œë¡ (Melon) ì°¨íŠ¸")    

    with tab2:
        st.subheader("íšŒê·€ë¶„ì„")
        st.markdown("""
        - ë‹¨ìˆœíˆ 2020~2024ë…„ê³¼ 2025ë…„ 11ì›”ì„ ë‘ ì§‘ë‹¨ìœ¼ë¡œë§Œ ë¹„êµí•˜ë©´, **ì‹œê°„ íë¦„ì— ë”°ë¥¸ ì¦ê°€/ê°ì†Œ ì¶”ì´**ë¥¼ íŒŒì•…í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.  
        - ì´ì— ì—°ë„ë³„(ì›”ë³„) ë¡/ë©”íƒˆ ê³¡ ìˆ˜ì˜ ë³€í™”ë¥¼ **ì‚°ì ë„ë¡œ í™•ì¸**í•˜ê³ , **ìµœì†Œì œê³±ë²•(OLS)**ìœ¼ë¡œ **ì¶”ì •íšŒê·€ì§ì„ **ì„ ê·¸ë ¤
          ì—°ë„ì— ë”°ë¥¸ ì¦ê°€/ê°ì†Œ ê²½í–¥(ê¸°ìš¸ê¸°)ì„ í™•ì¸í•©ë‹ˆë‹¤.
        - ë˜í•œ **ê¸°ìš¸ê¸°(íšŒê·€ëª¨ìˆ˜) ìœ ì˜ì„± ê²€ì •**ê³¼ **ê²°ì •ê³„ìˆ˜(RÂ²), F-ê²€ì •**ì„ í†µí•´ ì§ì„  ê´€ê³„ê°€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œì§€ íŒë‹¨í•©ë‹ˆë‹¤.
        """)

        st.markdown("##### ğŸ“Œ ì‚¬ìš© ë°ì´í„° (ì—°ë„ë³„/ì›”ë³„ ë¡/ë©”íƒˆ ê³¡ ìˆ˜, TOP100 ê¸°ì¤€)")
        reg_counts = {
            "ì—°ë„/ì›”": ["2020", "2021", "2022", "2023", "2024", "2025_11"],
            "ë¡/ë©”íƒˆ ê³¡ ìˆ˜ (TOP100 ê¸°ì¤€)": [7, 6, 5, 4, 9, 11]
        }
        st.dataframe(reg_counts, use_container_width=False)

        st.markdown("""
        **[ë‹¨ìˆœì„ í˜•íšŒê·€]**
        - **ì„¤ëª…ë³€ìˆ˜(X)**: ì—°ë„(year)
        - **ë°˜ì‘ë³€ìˆ˜(Y)**: ë¡/ë©”íƒˆ ê³¡ ìˆ˜(rock_metal_count)
        - **ìœ ì˜ìˆ˜ì¤€(Î±)**: 0.05
        - **ê·€ë¬´ê°€ì„¤(Hâ‚€)**: ê¸°ìš¸ê¸°(Î²â‚) = 0  (ì—°ë„ì™€ ê³¡ ìˆ˜ ì‚¬ì´ì— ì„ í˜• ê´€ê³„ê°€ ì—†ë‹¤)
        """)

        # ì‹œê°í™” + ê²°ê³¼
        fig, stats = plot_regression(df)
        st.pyplot(fig)
        plt.close(fig)

        st.write("íšŒê·€ ê²°ê³¼(í•µì‹¬):")
        st.json({
            "ê¸°ìš¸ê¸°(beta1)": float(stats["beta1"]),
            "ì ˆí¸(beta0)": float(stats["beta0"]),
            "RÂ²": float(stats["r2"]),
            "F": float(stats["f"]),
            "F p-value": float(stats["f_pvalue"])
        })

        # í•µì‹¬ ì§€í‘œ metric
        c1, c2, c3 = st.columns(3)
        c1.metric("ê¸°ìš¸ê¸° Î²â‚", f'{stats["beta1"]:.3f}')
        c2.metric("RÂ²", f'{stats["r2"]:.3f}')
        c3.metric("F p-value", f'{stats["f_pvalue"]:.4g}')

        st.markdown("##### ğŸ” ë¶„ì„ ê²°ê³¼")
        st.markdown(f"""
        - íšŒê·€ëª¨í˜•ì—ì„œ ê¸°ìš¸ê¸°(Î²â‚)ëŠ” **{stats["beta1"]:.3f}**ì´ë©°, ì´ì— ëŒ€í•œ **p-value**ëŠ” **{stats["f_pvalue"]:.4g}** ì…ë‹ˆë‹¤.  
        - **ìœ ì˜ìˆ˜ì¤€ 0.05**ì™€ ë¹„êµí–ˆì„ ë•Œ p-valueê°€ ë” í¬ë¯€ë¡œ, **ê¸°ìš¸ê¸°ëŠ” í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
        - ê²°ì •ê³„ìˆ˜(RÂ²)ëŠ” **{stats["r2"]:.3f}**ë¡œ 0ì— ë¹„êµì  ê°€ê¹ê³ , **F-ê²€ì •**ì˜ ìœ ì˜í™•ë¥  ë˜í•œ **{stats["f_pvalue"]:.4g}**ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        - ë”°ë¼ì„œ **ê·€ë¬´ê°€ì„¤(Hâ‚€)ì„ ê¸°ê°í•˜ì§€ ëª»í•©ë‹ˆë‹¤.**
        """)

        st.markdown("##### âœï¸ í•´ì„")
        st.info("""
        - ë³¸ íšŒê·€ë¶„ì„ ê²°ê³¼ë§Œìœ¼ë¡œëŠ” **ì—°ë„ì™€ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ ì‚¬ì´ì— ìœ ì˜í•œ ì„ í˜• ê´€ê³„ê°€ ìˆë‹¤ê³  ë§í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.**
        - ì´ëŠ” (ì•ì„ ) **ì´í‘œë³¸ ëª¨ë¹„ìœ¨ ê²€ì • ê²°ê³¼ì™€ëŠ” ë‹¤ë¥¸ ê²°ë¡ **ì„ ë³´ì…ë‹ˆë‹¤.
        """)

        st.markdown("""
        **í•œê³„ ë° ì›ì¸**
        - ì‚°ì ë„ë¥¼ ë³´ë©´ 2020~2023ë…„ì—ëŠ” ê°ì†Œí•˜ë‹¤ê°€ 2024ë…„ì— ê¸‰ê²©íˆ ì¦ê°€í•˜ê³  2025ë…„ê¹Œì§€ ì¦ê°€í•˜ëŠ” í˜•íƒœë¡œ,
          ë‹¨ìˆœí•œ ì§ì„ (ì„ í˜•)ë³´ë‹¤ëŠ” **ë¹„ì„ í˜•ì **ì¸ ëª¨ìŠµì„ ë³´ì…ë‹ˆë‹¤.
        - ë”°ë¼ì„œ ì´ ë°ì´í„°ì—ì„œëŠ” **ë‹¨ìˆœ ì„ í˜•íšŒê·€ë§Œìœ¼ë¡œ ì¶”ì„¸ë¥¼ ì„¤ëª…í•˜ê¸° ì–´ë µë‹¤**ëŠ” í•œê³„ê°€ ìˆìœ¼ë©°,
          íšŒê·€ë¶„ì„ ì™¸ì˜ ë‹¤ë¥¸ ê²€ì •/ëª¨í˜•ì„ í•¨ê»˜ ì ìš©í•´ ë³¼ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.
        """)

        st.markdown("---")
        st.caption("ğŸ“ ë°ì´í„° ì¶œì²˜: ë©œë¡ (Melon) ì°¨íŠ¸")

    with tab3:
        st.subheader("t-ê²€ì •")

        st.markdown("""
        - ì‚°ì ë„ ë° íšŒê·€ë¶„ì„ ê²°ê³¼, 2020~2023ë…„ê¹Œì§€ëŠ” ë¡/ë©”íƒˆ ê³¡ ìˆ˜ê°€ ê°ì†Œí•˜ë‹¤ê°€  
          2024ë…„ ì´í›„ ì¦ê°€í•˜ëŠ” ì–‘ìƒì´ ê´€ì¸¡ë˜ì—ˆìŠµë‹ˆë‹¤.
        - ì´ì— ì—°ë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‘ ì§‘ë‹¨ìœ¼ë¡œ ë‚˜ëˆ„ì–´,  
          **2024ë…„ ì´í›„ì˜ ë¡/ë©”íƒˆ ê³¡ ìˆ˜ í‰ê· ì´ ì´ì „ë³´ë‹¤ ì¦ê°€í•˜ì˜€ëŠ”ì§€** í™•ì¸í•˜ê³ ì
          ì´í‘œë³¸ t-ê²€ì •ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
        """)

        st.markdown("""
        **ê°€ì„¤ ì„¤ì •**
        - **ê·€ë¬´ê°€ì„¤(Hâ‚€)** : ë‘ ì§‘ë‹¨ì˜ ëª¨í‰ê· ì´ ê°™ë‹¤.
        - **ëŒ€ë¦½ê°€ì„¤(Hâ‚)** : 2024ë…„ë„ ì´í›„ ì§‘ë‹¨ì˜ ëª¨í‰ê· ì´ ë” í¬ë‹¤.
        - **ìœ ì˜ìˆ˜ì¤€(Î±)** : 0.05
        """)

        # t-test ì‹¤í–‰ + ì‹œê°í™”
        fig, stats = plot_ttest(df, cut_year=2023)
        st.pyplot(fig)
        plt.close(fig)

        st.write("ê²€ì • ê²°ê³¼(ìˆ«ì):")
        st.json(stats)

        # í•µì‹¬ ì§€í‘œ ê°•ì¡°
        c1, c2 = st.columns(2)
        c1.metric("ê²€ì •í†µê³„ëŸ‰(t)", f'{stats["t"]:.6f}')
        c2.metric("p-value", f'{stats["p_value"]:.6f}')

        st.markdown("##### ğŸ” ë¶„ì„ ê²°ê³¼")
        st.markdown("""
        - ê²€ì •í†µê³„ëŸ‰ì˜ ê°’ = **3.7807562268756265**
        - p-value = **0.03438823104650807**
        """)

        st.success("""
        ìœ ì˜í™•ë¥ ì´ ì•½ 3%ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì—  
        **ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ë°›ì•„ë“¤ì…ë‹ˆë‹¤.**
        """)

        st.markdown("##### âœï¸ í•´ì„")
        st.markdown("""\
        ì¦‰, 2024ë…„ ì´í›„ì˜ ê³¡ ìˆ˜ í‰ê· ì´ ì¦ê°€í•˜ì˜€ìœ¼ë¯€ë¡œ  
        ë©œë¡  ìŒì› ë°ì´í„° ìƒìœ¼ë¡œ **â€˜ë°´ë“œ ë¶â€™ì€ 2024ë…„ ì‚¬ì´ ì°¾ì•„ì™”ë‹¤ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**
        """)

        st.markdown("---")
        st.caption("ğŸ“ ë°ì´í„° ì¶œì²˜: ë©œë¡ (Melon) ì°¨íŠ¸")


def section_2_3():
    st.header("2.3 ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜")

    st.subheader("ğŸ•ºë½í˜ìŠ¤í‹°ë²Œ")
    st.markdown("""
    íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜ íšŒê·€ë¶„ì„ì„ í†µí•´  
    ê´€ëŒê° ìˆ˜ê°€ ì–´ëŠ ì •ë„ì˜ ê¸°ìš¸ê¸°ë¡œ ì¦ê°€í•˜ê³  ìˆëŠ”ì§€ ì•Œì•„ë³´ê³ ,  
    íšŒê·€ëª¨í˜•ì„ í™œìš©í•˜ì—¬ **2026ë…„ íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜ë¥¼ ì˜ˆì¸¡**í•˜ê³ ì í•©ë‹ˆë‹¤.

    ì´ì— ì¦ê°€/ê°ì†Œ ì¶”ì´ë¥¼ ì‚°ì ë„ë¡œ íŒŒì•…í•˜ê³ ,  
    ìµœì†Œì œê³±ë²•ì„ í†µí•´ ì¶”ì •íšŒê·€ì§ì„ ì„ ê·¸ë¦° ë’¤,  
    íšŒê·€ëª¨í˜•ì˜ ê¸°ìš¸ê¸°ì— ëŒ€í•œ ì¶”ë¡ ê³¼ ê²°ì •ê³„ìˆ˜ë¥¼ í™œìš©í•œ **F-ê²€ì •**ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

    ë§Œì•½ ì§ì„ ê´€ê³„ê°€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê³ ,  
    ê¸°ìš¸ê¸°ê°€ ì–‘ìˆ˜ë¼ë©´ ìœ„ì˜ ë¶„ì„ ê²°ê³¼ëŠ” **ë°´ë“œ ë¶ì´ ì™”ë‹¤ëŠ” ê²ƒì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±°**ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    """)

    st.markdown("##### ğŸ“Š íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ ì—°ë„ë³„ ê´€ëŒê° ìˆ˜")
    penta = {
        "year": [2025, 2024, 2023, 2022, 2019],
        "visitor": [166000, 150000, 150000, 130000, 95000]
    }
    penta_df = pd.DataFrame(penta)
    st.dataframe(penta_df, use_container_width=True)

    st.markdown("""
    **ë‹¨ìˆœì„ í˜•íšŒê·€**
    - **ì„¤ëª…ë³€ìˆ˜(X)** : ì—°ë„(year)
    - **ë°˜ì‘ë³€ìˆ˜(Y)** : íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜
    - **ìœ ì˜ìˆ˜ì¤€(Î±)** : 0.05
    - **ê·€ë¬´ê°€ì„¤(Hâ‚€)** : ê¸°ìš¸ê¸°(year íšŒê·€ëª¨ìˆ˜) = 0
    """)

    # íšŒê·€ë¶„ì„ ì‹¤í–‰
    fig, stats = penta_regression(penta_df)
    st.pyplot(fig)
    plt.close(fig)

    st.write("íšŒê·€ ê²°ê³¼(í•µì‹¬):")
    st.json(stats)

    # í•µì‹¬ ì§€í‘œ ê°•ì¡°
    c1, c2, c3 = st.columns(3)
    c1.metric("ê¸°ìš¸ê¸°", f'{stats["beta1"]:.0f}')
    c2.metric("RÂ²", f'{stats["r2"]:.3f}')
    c3.metric("F p-value", f'{stats["f_pvalue"]:.4g}')

    st.markdown("##### ğŸ” ë¶„ì„ ê²°ê³¼")
    st.markdown("""
    - ì¶”ì •íšŒê·€ì§ì„ ì˜ ê¸°ìš¸ê¸°ëŠ” **1.172Ã—10â´**ë¡œ, ì—°ë„ê°€ ì¦ê°€í•¨ì— ë”°ë¼ ê´€ëŒê° ìˆ˜ê°€ ì¦ê°€í•˜ëŠ” ê²½í–¥ì„ ë³´ì…ë‹ˆë‹¤.
    - ê²€ì •í†µê³„ëŸ‰(tê°’)ì€ **10.840**, ì´ì— ëŒ€í•œ **ìœ ì˜í™•ë¥ ì€ ì•½ 0.002**ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ ë§¤ìš° ì‘ìŠµë‹ˆë‹¤.
    - ê²°ì •ê³„ìˆ˜ëŠ” **0.975**, ìˆ˜ì •ê²°ì •ê³„ìˆ˜ëŠ” **0.967**ì´ë©°  
      Fê°’ì€ **117.5**, ì´ì— ëŒ€í•œ p-valueëŠ” **0.00168**ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•©ë‹ˆë‹¤.
    """)

    st.success("""
    ìœ„ì˜ ê²°ê³¼ì— ë”°ë¼ **ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°**í•  ìˆ˜ ìˆìœ¼ë©°,  
    ì„¤ëª…ë³€ìˆ˜(ì—°ë„)ê°€ ë°˜ì‘ë³€ìˆ˜(ê´€ëŒê° ìˆ˜)ë¥¼ ì¶©ë¶„íˆ ì„¤ëª…í•˜ê³  ìˆëŠ”  
    **ì˜ ì í•©ëœ íšŒê·€ëª¨í˜•**ì´ë¼ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    """)

    st.markdown("##### ğŸ‘¨â€ğŸ’» ì˜ˆì¸¡ ê²°ê³¼")
    st.markdown(f"""
    - ìœ„ì˜ íšŒê·€ëª¨í˜•ì„ í™œìš©í•´ 2026ë…„ ê´€ëŒê° ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ë©´  
      **ì•½ {stats["pred_2026"]:,.0f}ëª…**ì´ë¼ëŠ” ê°’ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    """)

    st.markdown("##### âœï¸ í•´ì„")
    st.info("""
    ì¦‰, íœíƒ€í¬íŠ¸ ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜ëŠ” ì§€ì†ì ìœ¼ë¡œ ì¦ê°€í•˜ê³  ìˆìœ¼ë©°,  
    í•´ë‹¹ íšŒê·€ëª¨í˜•ì€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•˜ê¸° ë•Œë¬¸ì—  
    **ë½í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ìˆ˜ë¥¼ í†µí•´ì„œë„ â€˜ë°´ë“œ ë¶ì´ ì™”ë‹¤â€™ëŠ” ì ì„ ì„¤ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**
    """)

    st.markdown("---")
    st.caption("""
    ğŸ“ ë°ì´í„° ì¶œì²˜  
    - ì¸ì²œê´‘ì—­ì‹œ(2025), ì¸ì²œíœíƒ€í¬íŠ¸ ìŒì•…ì¶•ì œ 20ì£¼ë…„ ë³´ë„ìë£Œ  
    - ë”ì•„ì´ì—”ì”¨(The ICN), ì¸ì²œ íœíƒ€í¬íŠ¸ ìŒì•…ì¶•ì œ ê´€ë ¨ ê¸°ì‚¬  
    - ì¸ì²œíˆ¬ë°ì´, ì¸ì²œ íœíƒ€í¬íŠ¸ ìŒì•…ì¶•ì œ ë³´ë„  
    - ê²½í–¥ì‹ ë¬¸ ìŠ¤í¬ì¸ ê²½í–¥(2022), íœíƒ€í¬íŠ¸ ë½ í˜ìŠ¤í‹°ë²Œ ê´€ë ¨ ê¸°ì‚¬  
    - ê²½ê¸°ì¼ë³´(2019), ì¸ì²œ íœíƒ€í¬íŠ¸ ë½ í˜ìŠ¤í‹°ë²Œ ê´€ëŒê° ë³´ë„
    """)


def section_3_1():
    st.header("3.1 ì‹œì‚¬ì ")
    st.subheader("ğŸ¤” ë°´ë“œ ë¶ ì˜ì˜")
    st.write("""
    **â€˜ë°´ë“œ ë¶ì´ ì˜¨ë‹¤â€™ì— ëŒ€í•´ ì´í•´í•˜ëŠ” ê²ƒ**ì€ ë‹¤ìŒê³¼ ê°™ì€ ì—¬ëŸ¬ ê°€ì§€ ì˜ì˜ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

    ---

    #### 1. ë¬¸í™” í˜„ìƒì„ ì§ì ‘ ê²€ì¦í•œë‹¤ëŠ” ì 

    ì£¼ê´€ì ìœ¼ë¡œ â€œìš”ì¦˜ ë°´ë“œ ìŒì•…ì´ ë‹¤ì‹œ ìœ í–‰í•˜ëŠ” ê²ƒ ê°™ë‹¤â€ê³  ëŠë¼ëŠ” ì¸ìƒì„  
    ì–‘ì ì¸ ë°ì´í„° ìë£Œë¥¼ í†µí•´ êµ¬ì²´í™”í•˜ê³  ê²€ì¦í•¨ìœ¼ë¡œì¨,  
    í•´ë‹¹ ë‹´ë¡ ì„ ë³´ë‹¤ **ì •í™•í•˜ê³  ì„¤ë“ë ¥ ìˆëŠ” ì£¼ì¥**ìœ¼ë¡œ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ì¦‰, ê°œì¸ì˜ ì²´ê°ì— ë¨¸ë¬´ë¥´ì§€ ì•Šê³   
    ë¬¸í™” í˜„ìƒì„ ê²½í—˜ì ìœ¼ë¡œ ê²€í† í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œ ì¤‘ìš”í•œ ì˜ë¯¸ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

    ---

    #### 2. â€˜ë¶â€™ì´ ë°œìƒí•œ ì‹œì ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤ëŠ” ì 

    ìŒì› ë°ì´í„°ë¥¼ í™œìš©í•˜ë©´  
    ì–´ëŠ ì‹œì ë¶€í„° ë°´ë“œ ìŒì•…ì´ ì°¨íŠ¸ ìƒì—ì„œ ì¦ê°€í•˜ê¸° ì‹œì‘í–ˆëŠ”ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°,  
    ì´ë¥¼ í†µí•´ í•˜ìœ„ ë¬¸í™”ì˜ **ë³€ë™ ì‹œì **ì„ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ì´ëŠ” ë°´ë“œ ìŒì•…ì´ ë‹¨ìˆœíˆ â€˜ìœ í–‰í•œë‹¤â€™ëŠ” í‘œí˜„ì„ ë„˜ì–´,  
    **ì–¸ì œë¶€í„°, ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ë³€í™”í–ˆëŠ”ì§€**ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

    ---

    #### 3. ë°´ë“œ ìŒì•…ì´ ê°€ì§€ëŠ” ì‚¬íšŒì  ì¤‘ìš”ì„±ì„ ì´í•´í•  ìˆ˜ ìˆë‹¤ëŠ” ì 

    ìŒì•…ì€ ë‹¨ìˆœíˆ ê°œì¸ì˜ ê°ì •ì— ì˜í–¥ì„ ì£¼ëŠ” ë° ê·¸ì¹˜ì§€ ì•Šê³ ,  
    ì¸ê°„ì˜ í–‰ë™ê³¼ ê°ì •ì— ë°”ëŒì§í•œ ë³€í™”ë¥¼ ì¼ìœ¼í‚¤ë©°  
    ì‚¬íšŒì  êµë¥˜ ìˆ˜ë‹¨ìœ¼ë¡œì„œ êµ¬ì²´ì ì¸ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

    ë§¥ì¹´ì‹œì— ë”°ë¥´ë©´,  
    ê°ì •ì€ ì‚¬íšŒì  ê³¼ì •ì— ì˜í•´ í˜•ì„±ë˜ë©°  
    â€˜ê°ì •ì  ì‚¶â€™ì— ì‚¬íšŒì  ì¤‘ìš”ì„±ì„ ë¶€ì—¬í•˜ëŠ” í–‰ìœ„ìë“¤ê³¼ ì§‘ë‹¨ë“¤ì— ì˜í•´ ìƒì„±ë˜ëŠ” **ì‚¬íšŒì  ëŒ€ìƒ**ì…ë‹ˆë‹¤.

    ë˜í•œ ë’¤ë¥´ì¼(Durkheim)ì€  
    ì‚¬íšŒ ë˜ëŠ” ê³µë™ì²´ê°€ í•¨ê»˜ ëª¨ì—¬ ê°™ì€ ìƒê°ê³¼ í–‰ë™ì— ì°¸ì—¬í•˜ëŠ” ê³¼ì •ì—ì„œ  
    **ì§‘í•©ì  ê°ì •**ì´ í˜•ì„±ë˜ê³ , ì´ê²ƒì´ ì§‘ë‹¨ í†µí•©ì— ê¸°ì—¬í•œë‹¤ê³  ì„¤ëª…í•©ë‹ˆë‹¤.  

    ì½œë¦°ìŠ¤(Collins)ëŠ”  
    ê³ ë„ì˜ ìƒí˜¸ì£¼ê´€ì„±ì´ ê°ì •ì  í•©ë¥˜ì™€ ê²°í•©ë˜ë©´ì„œ  
    ì†Œì†ê°, ì—´ì •ê³¼ ê°™ì€ **ê°ì •ì  ì—ë„ˆì§€**ë¡œ ê·€ê²°ëœë‹¤ê³  ë§í•©ë‹ˆë‹¤.

    ì¦‰, ì°¸ì—¬ìë“¤ì´ ê°ì •ì Â·ì¸ì§€ì  ì²´í—˜ì„ ê³µìœ í•˜ëŠ” í•©ë¥˜ ê³¼ì •ì„ í†µí•´  
    ì§‘ë‹¨ ìœ ëŒ€, ì†Œì†ê°, ìì‹ ê°, ì—´ì •ê³¼ ê°™ì€ ê°ì •ì  ì—ë„ˆì§€ê°€ ìƒì„±ë˜ë©°,  
    ì´ëŠ” ìœ ëŒ€ì˜ ê°ì •ì„ ì‚°ì¶œí•˜ëŠ” ê¸°ë°˜ì´ ë©ë‹ˆë‹¤.

    ---

    #### 4. ì¢…í•©ì  ì˜ì˜

    ì´ëŸ¬í•œ ì ì—ì„œ ë°´ë“œ ìŒì•…ì€ ë‹¨ìˆœí•œ ì²­ê°ì  ê²½í—˜ì— ë¨¸ë¬¼ì§€ ì•Šê³ ,  
    ìŒì•…ì„ ë§¤ê°œë¡œ í˜•ì„±ëœ ê°ì •ê³¼ ì‚¬íšŒì  ê³¼ì •ì„ í†µí•´  
    **ê³µë™ì²´ì  ì—°ê²°ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ë¬¸í™”ì  ì¥ì¹˜**ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ë”°ë¼ì„œ â€˜ë°´ë“œ ë¶â€™ì— ëŒ€í•´ ë…¼ì˜í•˜ëŠ” ê²ƒì€  
    ì‚¬íšŒ ì† í•˜ìœ„ ë¬¸í™”ë¥¼ ë³´ë‹¤ êµ¬ì²´ì ìœ¼ë¡œ ì´í•´í•˜ëŠ” ì‘ì—…ì´ë©°,  
    ìŒì•…ì„ ë§¤ê°œë¡œ í•œ ì‚¬íšŒì  ê³¼ì •ê³¼ ê°ì •ì„ íƒêµ¬í•¨ìœ¼ë¡œì¨  
    ê¶ê·¹ì ìœ¼ë¡œëŠ” **ì‚¬íšŒ ì§‘ë‹¨ì— ëŒ€í•œ ì´í•´ë¡œ í™•ì¥ë  ìˆ˜ ìˆë‹¤ëŠ” ì˜ì˜**ë¥¼ ê°€ì§‘ë‹ˆë‹¤.
    """)


    st.caption("""
    **ì¶œì²˜**

    ë¬¸ì„ í˜œ. "ìŒì•…ì¹˜ë£Œì˜ ì´í•´ì™€ ì ìš©ì— ê´€í•œ ì—°êµ¬." êµ­ë‚´ì„ì‚¬í•™ìœ„ë…¼ë¬¸ ì¤‘ì•™ëŒ€í•™êµ êµìœ¡ëŒ€í•™ì›, 2003. ì„œìš¸

    í•˜í™ê·œ. â€œê°ì •, ì‚¶, ì‚¬íšŒ â€• ê°ì • ì‚¬íšŒí•™ ì´ë¡ ë“¤â€, ì„¸ê³„ì •ì¹˜, 29(0), 109-157. 2018
    """)

def section_4_1():
    st.header("4.1 ìŒì•… ì¶”ì²œ")
    st.subheader("ğŸ¶ ë°´ë“œ ìŒì•… ì¶”ì²œ")
    st.write("í”„ë¡œì íŠ¸ë¥¼ ë§ˆë¬´ë¦¬í•˜ë©°, ì£¼ì œì™€ ê´€ë ¨í•´ ê°œì¸ì ìœ¼ë¡œ ì¢‹ì•„í•˜ëŠ” ë°´ë“œ ìŒì•…ë“¤ì„ ëª‡ ê³¡ ì†Œê°œí•˜ê³ ì í•©ë‹ˆë‹¤.")

    st.markdown("---")
    st.markdown("**Green day - Jesus Of Suburbia**")
    st.video("https://youtu.be/lPLvBO_2Gn0?si=Fec13rTe8aFpFe2q")

    st.markdown("---")
    st.markdown("**ê¹€ëœ»ëŒ - ê¿ˆì—ì„œ ê±¸ë ¤ì˜¨ ì „í™”**")
    st.video("https://youtu.be/NFuhikCmvkw?si=SbWDnrOIcc4dcllH")

    st.markdown("---")
    st.markdown("**SPYAIR - ã‚µãƒ ãƒ©ã‚¤ãƒãƒ¼ãƒˆ(Some Like it Hot)**")
    st.video("https://youtu.be/FgFnOK1wgu8?si=3vRQrL8fLwMREjVc")

    st.markdown("---")
    st.markdown("**Sum 41 - Still Waiting**")
    st.video("https://youtu.be/qO-mSLxih-c?si=Iio9bPO1jEc9kIPp")

    st.markdown("---")
    st.markdown("**Oasis - Champagne Supernova**")
    st.video("https://youtu.be/JmWvnoW7qKE?si=28cEC5_f7wESGbeW")



# ----------------------------
# ëª©ì°¨ ë§¤í•‘
# ----------------------------
toc_function = {
    "0.1 ë°´ë“œ ë¶ì€ ì˜¨ë‹¤" : section_0_1,
    "1.1 ë°´ë“œë€?": section_1_1,
    "1.2 ì—­ì‚¬ ë° ì¥ë¥´": section_1_2,
    "2.1 ë°ì´í„° ì½ê¸°": section_2_1,
    "2.2 ìŒì›ë°ì´í„°": section_2_2,
    "2.3 ë½í˜ìŠ¤í‹°ë²Œ": section_2_3,
    "3.1 ì‹œì‚¬ì ": section_3_1,
    "4.1 ìŒì•… ì¶”ì²œ": section_4_1,
}

# ì„ íƒ ì €ì¥ìš© ë³€ìˆ˜ ì´ˆê¸°ê°’
selected = "0.1 ë°´ë“œ ë¶ì€ ì˜¨ë‹¤"

st.sidebar.header("ğŸ¸ ëª©ì°¨")

for chapter, sections in toc.items():
    st.sidebar.markdown(f"### {chapter}")  # ì±•í„° ì œëª©
    for sec in sections:
        if st.sidebar.button(sec, key=sec):  # ê° ì„¹ì…˜ì„ ë²„íŠ¼ìœ¼ë¡œ í‘œì‹œ
            selected = sec

# ----------------------------
# ë³¸ë¬¸ í‘œì‹œ
# ----------------------------
toc_function[selected]()   # ì„ íƒëœ í•¨ìˆ˜ ì‹¤í–‰






